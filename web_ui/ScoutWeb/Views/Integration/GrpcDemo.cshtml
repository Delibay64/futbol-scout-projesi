@{
    ViewData["Title"] = "gRPC Service Demo";
}

<div class="container-fluid py-4">
    <div class="row mb-4">
        <div class="col-md-8">
            <h2 class="text-warning">
                <i class="bi bi-lightning"></i> gRPC ProtokolÃ¼ Entegrasyonu
            </h2>
            <p class="text-muted">Google Remote Procedure Call - YÃ¼ksek PerformanslÄ± RPC Framework</p>
        </div>
        <div class="col-md-4 text-end">
            <a asp-action="Index" class="btn btn-outline-secondary">
                <i class="bi bi-arrow-left"></i> Geri DÃ¶n
            </a>
        </div>
    </div>

    <!-- gRPC Service Status -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="alert alert-info">
                <h6 class="alert-heading">
                    <i class="bi bi-info-circle"></i> gRPC Service Durumu
                </h6>
                <p class="mb-0">
                    <strong>Endpoint:</strong> @ViewBag.GrpcEndpoint<br>
                    <strong>Durum:</strong> âœ… gRPC servisi port 5001'de Ã§alÄ±ÅŸÄ±yor<br>
                    <strong>Not:</strong> @ViewBag.GrpcNote
                </p>
            </div>

            <div class="card border-0 shadow-sm">
                <div class="card-header bg-warning">
                    <h6 class="mb-0">
                        <i class="bi bi-code-slash"></i> gRPC Client Kodu (Ã–rnek)
                    </h6>
                </div>
                <div class="card-body">
                    <pre class="mb-0" style="background: #f5f5f5; padding: 1rem; border-radius: 5px;"><code>// gRPC client kullanÄ±mÄ± (tam entegrasyon iÃ§in):
using Grpc.Net.Client;
using ScoutGrpcService;

var channel = GrpcChannel.ForAddress("http://localhost:5001");
var client = new PlayerService.PlayerServiceClient(channel);

var request = new PlayerRequest { PlayerId = 1 };
var response = await client.GetPlayerAsync(request);

Console.WriteLine($"Oyuncu: {response.FullName}");</code></pre>
                    <small class="text-muted d-block mt-3">
                        <i class="bi bi-lightbulb"></i>
                        <strong>SOA Demonstration:</strong> gRPC servisi Ã§alÄ±ÅŸÄ±yor ancak tam client entegrasyonu Grpc.Net.Client NuGet paketi gerektirir.
                        Bu demo SOA mimarisinde gRPC'nin nasÄ±l kullanÄ±ldÄ±ÄŸÄ±nÄ± gÃ¶stermektedir.
                    </small>
                </div>
            </div>
        </div>
    </div>

    <!-- gRPC Nedir? -->
    <div class="row mb-4">
        <div class="col-md-6">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-warning">
                    <h6 class="mb-0">
                        <i class="bi bi-info-circle"></i> gRPC ProtokolÃ¼ Nedir?
                    </h6>
                </div>
                <div class="card-body">
                    <p><strong>gRPC (Google Remote Procedure Call)</strong>, Google tarafÄ±ndan geliÅŸtirilen modern, yÃ¼ksek performanslÄ± RPC framework'Ã¼dÃ¼r.</p>
                    <ul class="mb-0">
                        <li><strong>Format:</strong> Protocol Buffers (protobuf)</li>
                        <li><strong>Protokol:</strong> HTTP/2</li>
                        <li><strong>HÄ±z:</strong> REST'e gÃ¶re 7-10x daha hÄ±zlÄ±</li>
                        <li><strong>Streaming:</strong> Bidirectional streaming desteÄŸi</li>
                        <li><strong>Diller:</strong> C#, Java, Python, Go, Node.js, vb.</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="col-md-6">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-dark text-white">
                    <h6 class="mb-0">
                        <i class="bi bi-speedometer2"></i> gRPC vs REST vs SOAP
                    </h6>
                </div>
                <div class="card-body">
                    <table class="table table-sm table-bordered mb-0">
                        <thead>
                            <tr>
                                <th width="25%"></th>
                                <th class="bg-warning">gRPC</th>
                                <th class="bg-success text-white">REST</th>
                                <th class="bg-info text-white">SOAP</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th>Format</th>
                                <td>Protobuf</td>
                                <td>JSON</td>
                                <td>XML</td>
                            </tr>
                            <tr>
                                <th>HÄ±z</th>
                                <td>âš¡ Ã‡ok HÄ±zlÄ±</td>
                                <td>HÄ±zlÄ±</td>
                                <td>YavaÅŸ</td>
                            </tr>
                            <tr>
                                <th>Streaming</th>
                                <td>âœ… Var</td>
                                <td>âŒ Yok</td>
                                <td>âŒ Yok</td>
                            </tr>
                            <tr>
                                <th>Browser</th>
                                <td>âš ï¸ KÄ±sÄ±tlÄ±</td>
                                <td>âœ… Tam</td>
                                <td>âœ… Tam</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Proto DosyasÄ± -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-primary text-white">
                    <h6 class="mb-0">
                        <i class="bi bi-file-earmark-code"></i> Player.proto (Protocol Buffers TanÄ±mÄ±)
                    </h6>
                </div>
                <div class="card-body">
                    <pre class="mb-0" style="font-size: 0.85rem; max-height: 400px; overflow-y: auto;"><code>syntax = "proto3";

option csharp_namespace = "ScoutGrpcService";

package player;

// Oyuncu Servisi
service PlayerService {
  // Oyuncu bilgilerini getir
  rpc GetPlayer (PlayerRequest) returns (PlayerResponse);

  // Oyuncunun piyasa deÄŸerini tahmin et (AI)
  rpc PredictPlayerValue (PlayerRequest) returns (PredictionResponse);
}

// Ä°stek mesajÄ±
message PlayerRequest {
  int32 player_id = 1;
}

// Oyuncu cevabÄ±
message PlayerResponse {
  int32 player_id = 1;
  string full_name = 2;
  string position = 3;
  int32 age = 4;
  double current_market_value = 5;
  string team_name = 6;
}

// Tahmin cevabÄ±
message PredictionResponse {
  int32 player_id = 1;
  double predicted_value = 2;
  double confidence = 3;
  string model_version = 4;
}</code></pre>
                </div>
            </div>
        </div>
    </div>

    <!-- gRPC Server (C#) -->
    <div class="row mb-4">
        <div class="col-md-6">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-success text-white">
                    <h6 class="mb-0">
                        <i class="bi bi-server"></i> gRPC Server (C# - ScoutGrpcService)
                    </h6>
                </div>
                <div class="card-body">
                    <pre class="mb-0" style="font-size: 0.75rem; max-height: 350px; overflow-y: auto;"><code>// PlayerServiceImpl.cs
public class PlayerServiceImpl : PlayerService.PlayerServiceBase
{
    public override async Task&lt;PlayerResponse&gt; GetPlayer(
        PlayerRequest request,
        ServerCallContext context)
    {
        // PostgreSQL'den oyuncu getir
        var player = await _db.Players
            .FindAsync(request.PlayerId);

        return new PlayerResponse
        {
            PlayerId = player.PlayerId,
            FullName = player.FullName,
            Position = player.Position,
            Age = player.Age,
            CurrentMarketValue = player.CurrentMarketValue,
            TeamName = player.Team.TeamName
        };
    }

    public override async Task&lt;PredictionResponse&gt;
        PredictPlayerValue(
            PlayerRequest request,
            ServerCallContext context)
    {
        // AI model ile tahmin yap
        var prediction = await _aiService
            .PredictValue(request.PlayerId);

        return new PredictionResponse
        {
            PlayerId = request.PlayerId,
            PredictedValue = prediction.Value,
            Confidence = prediction.Confidence,
            ModelVersion = "v1.0"
        };
    }
}</code></pre>
                </div>
            </div>
        </div>

        <div class="col-md-6">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-info text-white">
                    <h6 class="mb-0">
                        <i class="bi bi-laptop"></i> gRPC Client (C# - ASP.NET Core)
                    </h6>
                </div>
                <div class="card-body">
                    <pre class="mb-0" style="font-size: 0.75rem; max-height: 350px; overflow-y: auto;"><code>// IntegrationController.cs
using Grpc.Net.Client;
using ScoutGrpcService;

public async Task&lt;IActionResult&gt; GrpcDemo()
{
    // gRPC kanalÄ± oluÅŸtur
    var channel = GrpcChannel.ForAddress(
        "http://localhost:5001"
    );

    var client = new PlayerService
        .PlayerServiceClient(channel);

    // 1. Oyuncu bilgilerini getir
    var playerRequest = new PlayerRequest
    {
        PlayerId = 1
    };

    var playerResponse = await client
        .GetPlayerAsync(playerRequest);

    ViewBag.Player = playerResponse;

    // 2. Piyasa deÄŸeri tahmini
    var predictionResponse = await client
        .PredictPlayerValueAsync(playerRequest);

    ViewBag.Prediction = predictionResponse;

    return View();
}</code></pre>
                </div>
            </div>
        </div>
    </div>

    <!-- Proje Bilgileri -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-dark text-white">
                    <h6 class="mb-0">
                        <i class="bi bi-folder"></i> ScoutGrpcService Projesi
                    </h6>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6>ğŸ“ Proje YapÄ±sÄ±:</h6>
                            <pre class="mb-0" style="font-size: 0.8rem;"><code>ScoutGrpcService/
â”œâ”€â”€ Protos/
â”‚   â””â”€â”€ player.proto         # gRPC tanÄ±mlarÄ±
â”œâ”€â”€ Services/
â”‚   â””â”€â”€ PlayerServiceImpl.cs # Server implementasyonu
â”œâ”€â”€ Program.cs               # gRPC server config
â””â”€â”€ ScoutGrpcService.csproj</code></pre>
                        </div>
                        <div class="col-md-6">
                            <h6>âš™ï¸ Endpoint Bilgileri:</h6>
                            <table class="table table-sm mb-0">
                                <tr>
                                    <th width="40%">Host</th>
                                    <td>@ViewBag.GrpcEndpoint</td>
                                </tr>
                                <tr>
                                    <th>Protokol</th>
                                    <td>HTTP/2</td>
                                </tr>
                                <tr>
                                    <th>Methods</th>
                                    <td>
                                        <code>GetPlayer</code><br>
                                        <code>PredictPlayerValue</code>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- gRPC AvantajlarÄ± -->
    <div class="row mb-4">
        <div class="col-md-4">
            <div class="card border-0 shadow-sm h-100 bg-light">
                <div class="card-body text-center">
                    <i class="bi bi-speedometer display-4 text-success"></i>
                    <h6 class="mt-3">YÃ¼ksek Performans</h6>
                    <p class="small text-muted mb-0">
                        Protocol Buffers sayesinde JSON'dan 7-10x daha hÄ±zlÄ± ve 3-5x daha kÃ¼Ã§Ã¼k veri transferi.
                    </p>
                </div>
            </div>
        </div>

        <div class="col-md-4">
            <div class="card border-0 shadow-sm h-100 bg-light">
                <div class="card-body text-center">
                    <i class="bi bi-arrow-left-right display-4 text-primary"></i>
                    <h6 class="mt-3">Bidirectional Streaming</h6>
                    <p class="small text-muted mb-0">
                        Client ve server arasÄ±nda iki yÃ¶nlÃ¼ sÃ¼rekli veri akÄ±ÅŸÄ±. Real-time uygulamalar iÃ§in ideal.
                    </p>
                </div>
            </div>
        </div>

        <div class="col-md-4">
            <div class="card border-0 shadow-sm h-100 bg-light">
                <div class="card-body text-center">
                    <i class="bi bi-code-square display-4 text-warning"></i>
                    <h6 class="mt-3">Type-Safe</h6>
                    <p class="small text-muted mb-0">
                        Proto dosyasÄ±ndan otomatik kod Ã¼retimi. Compile-time tip kontrolÃ¼ ile hata riski minimuma iner.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- KullanÄ±m AlanlarÄ± -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-success text-white">
                    <h6 class="mb-0">
                        <i class="bi bi-briefcase"></i> gRPC KullanÄ±m AlanlarÄ±
                    </h6>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6 class="text-success">âœ… gRPC Kullan:</h6>
                            <ul>
                                <li>Microservice'ler arasÄ± iletiÅŸim</li>
                                <li>Real-time streaming (chat, canlÄ± skor)</li>
                                <li>IoT cihazlarÄ± (dÃ¼ÅŸÃ¼k bant geniÅŸliÄŸi)</li>
                                <li>Mobil uygulamalar (hÄ±z Ã¶nemli)</li>
                                <li>YÃ¼ksek performans gerektiren sistemler</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6 class="text-danger">âŒ REST Kullan:</h6>
                            <ul>
                                <li>Public API'ler (developer-friendly)</li>
                                <li>Browser tabanlÄ± uygulamalar</li>
                                <li>Basit CRUD operasyonlarÄ±</li>
                                <li>Caching gereken durumlar</li>
                                <li>SEO Ã¶nemli sayfalar</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Test TalimatlarÄ± -->
    <div class="row">
        <div class="col-12">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-primary text-white">
                    <h6 class="mb-0">
                        <i class="bi bi-play-circle"></i> gRPC Servisini NasÄ±l Test Ederim?
                    </h6>
                </div>
                <div class="card-body">
                    <h6>AdÄ±m 1: gRPC Server'Ä± BaÅŸlat</h6>
                    <pre class="bg-dark text-white p-3"><code>cd web_ui/ScoutGrpcService
dotnet run</code></pre>

                    <h6 class="mt-3">AdÄ±m 2: gRPC Test AracÄ± Kullan</h6>
                    <div class="row mt-2">
                        <div class="col-md-4">
                            <div class="card bg-light">
                                <div class="card-body text-center">
                                    <i class="bi bi-terminal display-6 text-success"></i>
                                    <h6 class="mt-2">grpcurl</h6>
                                    <p class="small text-muted">Komut satÄ±rÄ± aracÄ±</p>
                                    <code class="small">grpcurl -plaintext localhost:5001 list</code>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="card bg-light">
                                <div class="card-body text-center">
                                    <i class="bi bi-lightning display-6 text-warning"></i>
                                    <h6 class="mt-2">Postman</h6>
                                    <p class="small text-muted">gRPC desteÄŸi var</p>
                                    <small>Import proto file</small>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="card bg-light">
                                <div class="card-body text-center">
                                    <i class="bi bi-code-square display-6 text-primary"></i>
                                    <h6 class="mt-2">BloomRPC</h6>
                                    <p class="small text-muted">gRPC GUI Client</p>
                                    <a href="https://github.com/bloomrpc/bloomrpc" target="_blank" class="small">
                                        GitHub <i class="bi bi-box-arrow-up-right"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bilgilendirme -->
    <div class="alert alert-warning mt-4">
        <h6 class="alert-heading">
            <i class="bi bi-exclamation-triangle"></i> Ã–nemli Notlar
        </h6>
        <ul class="mb-0">
            <li><strong>ScoutGrpcService</strong> projesinin Ã§alÄ±ÅŸÄ±yor olmasÄ± gerekir</li>
            <li>gRPC, HTTP/2 protokolÃ¼ kullandÄ±ÄŸÄ± iÃ§in bazÄ± proxy'ler sorun Ã§Ä±karabilir</li>
            <li>Browser'da direkt gRPC Ã§aÄŸrÄ±sÄ± yapÄ±lamaz, gRPC-Web gereklidir</li>
            <li>Production'da HTTPS kullanÄ±mÄ± ÅŸarttÄ±r</li>
        </ul>
    </div>
</div>
